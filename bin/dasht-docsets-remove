#!/bin/sh -e
#
# Usage: dasht-docsets-remove [NAME...]
#
# Removes installed Dash docsets whose names loosely match the given NAMEs.
# You are asked to confirm this destructive operation for every such match.
#
# If no NAMEs are specified, all installed docsets are selected for removal.
#
# Written in 2016 by Suraj N. Kurapati <https://github.com/sunaku/dasht>
# Distributed under the terms of the ISC license (see the LICENSE file).

: ${DASHT_DOCSETS_DIR:=${XDG_DATA_HOME:-$HOME/.local/share}/dasht/docsets}

set -- $(dasht-docsets "$@")
echo "Removable docsets ($#):\n\n\t$(echo "$*" | sed 's/ /,&/g')\n"

for docset; do
  echo "Remove $docset docset" | xargs -p | grep -q . || continue # confirm

  rootname="$DASHT_DOCSETS_DIR/$docset"
  rm -f -r "$rootname".docset \
           "$rootname".tgz
done
